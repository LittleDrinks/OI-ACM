---
tags:
  - 笔记
aliases:
  - "#生成函数"
---
# 形式幂级数

> [!note] 形式幂级数
> 多项式：$A(x)=\sum_{i=0}^n a_ix^i$
> 形式幂级数：$A(x)=\sum_{i\ge 0} a_ix^i$

> [!note] 形式幂级数的运算
> $A(x)+B(x)=\sum_{i\ge 0}(a_i+b_i)x^i$
> $A(x)-B(x)=\sum_{i\ge 0}(a_i-b_i)x^i$
> $A(x)\times B(x)=\sum_{k\ge 0}(\sum_{i+j=k}a_i+b_j)x^k$

记形式幂级数 $A(x)$ 的 $n$ 次项系数为 $[x^n]A(x)$

形式幂级数 $A(x)$ 的逆元 $B(x)$ 满足 $A(x)B(x)=1$
$A(x)B(x)=a_0b_0+(a_0b_1+a_1b_0)x+\ldots$，从第 $0$ 项开始往后递推，每一项只有一个未知数
$A(x)$ 逆元存在的条件为 $[x^0]A(x)\ne 0$

常见的逆元
$A(x)=\sum_{i\ge0}x^i$ 和 $B(x)=1-x$
$A(x)=\sum_{i\ge 0} a^ix^i$ 和 $B(x)=1-ax$
$A(x)=\sum_{i\ge 0} {i+k-1\choose i}x^i$ 和 $B(x)=(1-x)^k$

# 常生成函数

> [!note] 常生成函数
> 一个数列 $\{a_n\}$ 对应的常生成函数为 $A(x)=\sum_{n\ge 0} a_nx^n$

> [!note] 定理
> 设 $S=\{a_1,a_2,\ldots,a_k\}$，且 $a_i$ 可以取的次数的集合为 $M_i$。
> 记 $F_i(x)=\sum_{u\in M_i}x^u$
> 则从 $S$ 中取出 $n$ 个元素组成集合的方案数 $g(n)$ 的常生成函数 $G(x)=\sum_{i\ge 0}g(i)x^i$ 满足
> $$
> G(x)=\prod_{i=1}^kf_i(x)
> $$

> [!faq] 不定方程解的数量
> 把第 $i$ 项看作一个常生成函数，指数上写 $i$ 位置想要填的数字，系数为方案数
> 可以拓展不定方程的形式，比如限制第 $i$ 项必须在 $[L_i,R_i]$，或者计算不定方程 $\sum_{i=1}^na_ix_i=m$ 的解的数量

## 递推关系

> [!faq] 斐波那契数列
> ![[Pasted image 20250803222959.png]]

![[Pasted image 20250803223957.png]]

![[Pasted image 20250803225314.png]]

# 指数生成函数

> [!note] 指数生成函数
> 一个数列的指数生成函数定义为 $A(x)=\displaystyle\sum_{n\ge 0} a_n \frac{x^n}{n!}$

> [!faq] 有两种物体，取 $i$ 件第一种物品的方案数为 $a_i$，取 $j$ 件第二种物品的方案数为 $b_j$，求取出 $k$ 件物品并排放成一列的方案数
> 
> 设所求答案为 $g(k)$
> 先构造普通生成函数，取出 $k$ 件物品的生成函数为
> $$
> \bigg(\sum_{i\ge0}a_ix^i\bigg)\times\bigg(\sum_{j\ge0}b_jx^j\bigg)=\sum_{k\ge 0}a_ib_{k-i}x^k
> $$
> 在这个基础上，求并排放成一列的方案数。这相当于从 $k$ 个位置中选出 $i$ 个放第一种物品，剩下的位置放第二种物品，方案数为
> $$
> {k\choose i}= \dfrac{k!}{i!(k-i)!}
> $$
> 于是有 $\dfrac{1}{k!}g(k)x^k=a_n\dfrac{x^i}{i!}\cdot b_{k-i}\dfrac{x^{k-i}}{(k-i)!}$
> 构造指数生成函数
> $$
> A(x)=\sum_{n\ge0}a_n \dfrac{x^n}{n!},\ B(x)=\sum_{n\ge0}b_n \dfrac{x^n}{n!}
> $$
> 所求 $g(k)=k![x^k]A(x)B(x)$

> [!faq] 用数字 $1,2,3,4$ 作为六位数，且每种数字出现不能超过 $2$ 次，求有多少个不同的六位数
> 每个数字对应的指数生成函数都是 $F(x)=\displaystyle\sum_{n=0}^2\dfrac{x^n}{n!}=1+x+\dfrac{x}{2}$，即求 $6![x^6]F^6(x)$

> [!note] 定理
> 设 $S=\{a_1,a_2,\ldots,a_k\}$，且 $a_i$ 可以取的次数的集合为 $M_i$
> 记 $F_i(x)=\sum_{u\in M_i} \dfrac{x^u}{u!}$
> 则从 $S$ 中取出 $n$ 个元素排成一排的方案数 $g(n)$ 的指数生成函数 $G(x)=\sum_{i\ge 0}g(i) \dfrac{x^i}{i!}$ 满足
> $$
> G(x)=\prod_{i=1}^n F_i(x)
> $$

$\exp(x)=\displaystyle\sum_{n\ge 0} \dfrac{x^n}{n!}$
$\exp(ax)=\displaystyle\sum_{n\ge0}a^n \dfrac{x^n}{n!}$
