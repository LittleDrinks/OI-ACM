---
tags:
  - 题解
  - 模拟
aliases:
  - Deductive Snooker Scoring
---
## [QOJ14709. Deductive Snooker Scoring](https://qoj.ac/contest/2563/problem/14709)



[***AC 代码***](https://qoj.ac/submission/1618533)

```cpp
#include <bits/stdc++.h>
using namespace std;
using ll = long long;

void solve()
{
    int a, b, n, p;
    cin >> a >> b >> n >> p;
    int red_ball = min(15, 21-n);
    int col_ball = max(0, 6-n);

    auto calc = [&](int score, int len) -> pair<bool, vector<int>> {
        vector<int> res(2 * len);

        int now = len;
        for (int i = 0; i < len; ++i) {
            res[2*i] = 1;
            if (now + 2 <= score) {
                res[2*i+1] = 2;
                now += 2;
            }
        }
        for (int i = 0; i < len; ++i) {
            int d = min(5, score-now);
            if (res[2*i+1] == 2) {
                res[2*i+1] += d;
                now += d;
            }
        }
        return make_pair(now==score, res);
    };

    auto answer = [&](vector<int> va, vector<int> vb, int col) -> void {
        string ans;
        for (int i = 0; i < int(va.size()); ++i) {
            if (va[i] != 0) { ans += char('0' + va[i]); }
            else { ans += '/'; ans += '/'; }
        }
        ans += '/';
        
        for (int i = 0; i < int(vb.size()); ++i) {
            if (vb[i] != 0) { ans += char('0' + vb[i]); }
            else { ans += '/'; ans += '/'; }
        }
        ans += '/';

        int side = 0;
        for (int i = 0; i < col_ball; ++i) {
            int req_side = (col >> i & 1);
            if (side != req_side) {
                side ^= 1;
                ans += '/';
            }
            ans += char('2' + i);
        }

        if (side != p) {
            side ^= 1;
            ans += '/';
        }
        
        cout << ans << "\n";
    };

    for (int i = 0; i < (1 << col_ball); ++i) {
        int s[2] = {0, 0};
        for (int j = 0; j < col_ball; ++j) {
            s[i >> j & 1] += 2 + j;
        }

        if (col_ball == 6 && (i >> 5 & 1) != p) { continue; }

        for (int x = 0; x <= red_ball; ++x) {
            int y = red_ball - x;
            auto [valid1, va] = calc(a-s[0], x);
            auto [valid2, vb] = calc(b-s[1], y);
            if (valid1 && valid2) {
                answer(va, vb, i);
                return;
            }
        }
    }
    cout << "NA\n";
}

int main()
{
    ios::sync_with_stdio(0); cin.tie(0); cout.tie(0);
    int t = 1;
    cin >> t;
    while (t--) {
        solve();
    }
}
```
