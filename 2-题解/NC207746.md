---
tags:
  - 题解
  - 生成函数
aliases:
  - 背包
---
## [NC207746. 背包](https://ac.nowcoder.com/acm/problem/207746)

从生成函数的视角看取物品的方案。
形式幂的形式不太方便乘积，把它写成逆元的形式：

- 肥宅快乐水 $1+x=\dfrac{1-x^2}{1-x}$
- 大盘鸡 $1+x+x^2=\dfrac{1-x^3}{1-x}$
- 啤酒鸡 $1+x+x^2+x^3=\dfrac{1-x^4}{1-x}$
- 鸡翅 $\displaystyle\sum_{i\ge 0}x^{2i}=\dfrac{1}{1-x^2}$
- 鸡汤 $\displaystyle\sum_{i\ge0}x^{2i+1}=\dfrac{x}{1-x^2}$
- 鸡块 $\displaystyle\sum_{i\ge0}x^{4i}=\dfrac{1}{1-x^4}$
- 鸡腿 $1+x=\dfrac{1-x^2}{1-x}$
- 鸡蛋 $\displaystyle\sum_{i\ge0}x^{3i}=\dfrac{1}{1-x^3}$

全部乘起来得到选择物品的生成函数
$$
F(x)=\dfrac{x(1-x^2)^2(1-x^3)(1-x^4)}{(1-x)^4(1-x^2)^2(1-x^3)(1-x^4)}=\dfrac{x}{(1-x)^4}
$$
答案为 $[x^n]F(x)$。
逆元的形式不方便找到每一项的系数，把它写回形式幂的形式
$$
F(x)=x\sum_{i\ge0}{i+3\choose i}x^i
$$
因此答案为
$${n+2\choose 3}$$

[***AC 代码***](https://ac.nowcoder.com/acm/contest/view-submission?submissionId=78614013&returnHomeType=1&uid=379421591)

```cpp
#include <bits/stdc++.h>
using namespace std;
using ll = long long;
using db = long double;
using i128 = __int128;

const int MOD=1e9+7;
ll add(ll x, ll y) { return (x + y) % MOD; }
ll mul(ll x, ll y) { return (x * y) % MOD; }
ll qpow(ll a, ll b = MOD - 2) {
    ll res = 1;
    for (; b; b >>= 1) {
        if (b & 1) { res = mul(res, a); }
        a = mul(a, a);
    }
    return res;
}

void solve()
{
    ll n;
    cin >> n;
    n %= MOD;
    cout << mul(mul(mul(n+2, n+1), n), qpow(6)) << "\n";
}

int main()
{
    ios::sync_with_stdio(0); cin.tie(0); cout.tie(0); 
    int t = 1;
    // cin >> t;
    while (t--) { solve(); }
}
```
