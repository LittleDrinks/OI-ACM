---
tags:
  - 题解
  - DP/SOSDP
aliases:
  - Compatible Numbers
---
## [CF165E. Compatible Numbers](https://codeforces.com/problemset/problem/165/E)

将 $x$ 取反得到 $y$，如果 $x$ 能和 $a_i$ 相合，说明 $a_i$ 是 $y$ 的子集。比如
$$
\begin{align}
&y & 0{\color{red}{1}}0{\color{red}{1}}0{\color{red}{1}}{\color{red}{1}}\\
&x & 1{\color{orange}{0}}1{\color{orange}{0}}1{\color{orange}{0}}{\color{orange}{0}}\\
&a_i & 000{\color{orange}{1}}0{\color{orange}{1}}0
\end{align}
$$
对每个 $a_i$，尝试把它赋给它所有的超集。这可以用 SOS DP 在 $O(22\times2^{22})$ 的时间内维护。

[***AC 代码***](https://codeforces.com/contest/165/submission/331462786)

```cpp
#include <bits/stdc++.h>
using namespace std;
using ll = long long;
using db = long double;
using i128 = __int128;

void solve()
{
	int n;
	cin >> n;
    vector<int> a(n+1);
    for (int i = 1; i <= n; ++i) { cin >> a[i]; }
    vector<int> dp(1<<22, -1);
    for (int i = 1; i <= n; ++i) { dp[a[i]] = i; }
    for (int k = 0; k < 22; ++k) {
        for (int i = 0; i < (1<<22); ++i) {
            if ((i>>k&1) && dp[i^(1<<k)]!=-1) {
                dp[i] = dp[i^(1<<k)];
            }
        }
    }
    for (int i = 1; i <= n; ++i) {
        int x = a[i];
        for (int j = 0; j < 22; ++j) {
            x ^= 1 << j;
        }
        if (dp[x] == -1) { cout << "-1"; }
        else             { cout << a[dp[x]]; }
        cout << " \n"[i == n];
    }
}

int main()
{
	ios::sync_with_stdio(0); cin.tie(0); cout.tie(0); 
	int t = 1;
	// cin >> t;
	while (t--) { solve(); }
}
```
