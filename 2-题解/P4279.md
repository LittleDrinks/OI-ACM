---
tags:
  - 题解
  - 博弈论
aliases:
  - 小约翰的游戏
  - 反Nim游戏
---
## [P4279 [SHOI2008] 小约翰的游戏](https://www.luogu.com.cn/problem/P4279)

先考虑全是 $1$ 的情况，当 $n$ 是奇数时先手必胜，反之先手必败。
考虑若干个 $1$ 加上一个大于 $1$ 的数 $x$，此时先手必胜，因为他可以选择第一步拿掉 $x$ 或 $x-1$ 颗石头来控制剩余石头堆的奇偶性。
考虑不全是 $1$ 的状态，上述 $x,1,1,1\ldots$ 是必胜态，此时异或和不为零，套用 Nim 游戏的结论，此时先手异或和不为零为必胜态。

[***AC 代码***](https://www.luogu.com.cn/record/227930279)

```cpp
#include <bits/stdc++.h>
using namespace std;
using ll = long long;
using db = long double;
using i128 = __int128;

void solve()
{
	int n, cnt=0, sum=0;
	cin >> n;
    vector<int> a(n+1);
    for (int i = 1; i <= n; ++i) {
        cin >> a[i];
        sum ^= a[i];
        cnt += a[i] <= 1;
    }
    if (cnt == n) {
        cout << (n % 2 == 0 ? "John" : "Brother") << "\n";
    } else {
        cout << (sum != 0 ? "John" : "Brother") << "\n";
    }
}

int main()
{
	ios::sync_with_stdio(0); cin.tie(0); cout.tie(0); 
	int t = 1;
	cin >> t;
	while (t--) { solve(); }
}
```
