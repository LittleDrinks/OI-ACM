---
tags:
  - 题解
  - 概率与期望
  - DP
aliases:
  - Beautiful Mirrors
---
## [CF1265E. Beautiful Mirrors](https://codeforces.com/problemset/problem/1265/E)

$f(i)$ 表示从第一面镜子问到第 $i$ 面镜子，并感到高兴的期望天数，则有 $f(0)=0$，且
$$
f(i) = f(i-1) + 1 + \dfrac{100-p_i}{100} f(i)
$$
这个式子表示，最起码要交 $f(i-1)+1$ 的“入场费”，如果失败（$1-p$ 的概率）还要再来一次
解得
$$
f(i)=\dfrac{100}{p_i}\times\bigg(f(i-1) + 1 \bigg)
$$
时间复杂度 $O(n)$

[***AC 代码***](https://codeforces.com/contest/1265/submission/351420701)

```cpp
#include <bits/stdc++.h>
using namespace std;
using ll = long long;
using db = long double;
using i128 = __int128;

const int MOD = 998244353;
ll add(ll x, ll y) { return (x + y) % MOD; }
ll del(ll x, ll y) { return add(x, MOD - y); }
ll mul(ll x, ll y) { return (x * y) % MOD; }
ll qpow(ll a, ll b = MOD - 2) {
    ll res = 1;
    for (;b ; b >>= 1, a = mul(a, a)) {
        if (b & 1) { res = mul(res, a); }
    }
    return res;
}

void solve()
{
    int n;
    cin >> n;
    int ans = 0;
    for (int i = 1; i <= n; ++i) {
        int p;
        cin >> p;
        int c = mul(100, qpow(p));
        ans = mul(c, add(ans, 1));
    }
    cout << ans << "\n";
}

int main()
{
    ios::sync_with_stdio(0); cin.tie(0); cout.tie(0); 
    int t = 1;
    // cin >> t;
    while (t--) { solve(); }
}

```
