---
tags:
  - 题解
  - 数学
aliases:
  - Removal of a Sequence
---
## [CF2169D. Removal of a Sequence](https://codeforces.com/contest/2169/problem/D2)

倒着做，往前回退一次操作，相当于每 $y-1$ 个数字插入一个数字。
考虑 $k$ 左侧被插入了多少数字，大概是 $\dfrac{k}{y-1}$ 左右，当 $y-1\mid k$ 时会在 $k$ 右侧插入一个数字，这个数字需要额外减掉，因此可以将式子写为：
$$
k_{i-1} = k_i + \left\lfloor\dfrac{k-1}{y-1}\right\rfloor
$$
对于 D1，可以直接模拟这个过程，时间复杂度 $O(x)$
对于 D2，注意到 $\displaystyle\sum \left\lfloor\dfrac{k-1}{y-1}\right\rfloor\ge\sum_{i\ge1} i=O(n^2)$，因此 $\left\lfloor\dfrac{k-1}{y-1}\right\rfloor$ 至多有 $O(\sqrt{k})$ 种取值，将 $\left\lfloor\dfrac{k-1}{y-1}\right\rfloor$ 取值一样的那些操作合并在一起计算即可，时间复杂度 $O(\sqrt{A})$，$A$ 表示答案。
注意特判 $y=1$ 和 $A>10^{12}$ 的情况

[***AC 代码***](https://codeforces.com/contest/2169/submission/349446042)

```cpp
#include <bits/stdc++.h>
using namespace std;
using ll = long long;

void solve()
{
    ll x, y, k;
    cin >> x >> y >> k;
    if (y == 1) {
        cout << "-1\n"; return;
    }
    for (ll i = 0; i < x; ) {
        ll cur = (k - 1) / (y - 1);
        if (cur == 0) { break; }
        ll up = (cur + 1) * (y - 1) + 1;
        ll cnt = min(x - i, (up - k + cur - 1) / cur);
        k += cnt * cur;
        i += cnt;
        if (k > 1e12) {
            cout << "-1\n";
            return;
        }
    }
    cout << k << "\n";
}

int main()
{
    ios::sync_with_stdio(0); cin.tie(0); cout.tie(0);
    int T;
    cin >> T;
    while (T--) {
        solve();
    }
}
```
