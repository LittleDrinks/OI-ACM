---
tags:
  - 题解
  - 生成函数
aliases:
  - "[CEOI 2004] Sweets"
---
## [P6078 [CEOI 2004] Sweets](https://www.luogu.com.cn/problem/P6078)

前置题：[[CF451E]]
前半部分和 CF451E 一样，生成函数是
$$
G(x)=\dfrac{1}{(1-x)^n}\cdot\prod_{i=1}^n(1-x^{m_i+1})
$$
简记为 $G(x)=B(x)\cdot A(x)$，其中
$$
B(x)=\dfrac{1}{(1-x)^n}=\sum_{i\ge 0}{n+i-1\choose n-1}x^i
$$
即求
$$
\sum_{i}\Bigg([x^i]A(x)\times\sum_{j=a-i}^{b-i}[x^j]B(x)\Bigg)
$$

---

考虑如何计算组合数，简记 $L=a-i$，$R=b-i$，则
$$
\sum_{i=L}^R{n-1+i\choose n-1}={n-1+L\choose n} + \Bigg(\sum_{i=L}^R{n-1+i\choose n-1}\Bigg) - {n-1+L\choose n}
$$
根据杨辉三角 ${a\choose b}={a-1\choose b-1}+{a-1\choose b}$，得到前两项相加等于
$$
{n+R\choose n}
$$
对于模数非质数的除法，我们可以将模数乘上分母，再将运算结果除以分母得到答案。可以 $O(n)$ 求出，时间复杂度 $O(n2^n)$

> [!note] 模数非质数的除法
> 求 $\dfrac{A}{B}\mod M,\ M\notin Prime$
> 设 $A=kBM+r$，下证 $\dfrac{A}{B}\equiv \dfrac{r}{B}\pmod M$
> $r=A-kBM$，两侧同除 $B$ 得到 $r=\dfrac{A}{B}-kM$，在模 $M$ 意义下后一项为 $0$
> Q.E.D.


[***AC 代码***]()

```cpp

```
