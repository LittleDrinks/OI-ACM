---
tags:
---

```cpp
vector<int> sieve(int n)
{
	vector<bool> vis(n+1);
    vector<int> mP(n+1,1);
	vector<int> prime;
	vis[1] = 1;
	for (int i = 2; i <= n; ++i) {
		if (!vis[i]) {
            prime.push_back(i); 
            mP[i] = i;
        }
		for (auto p: prime) {
			if (i*p > n) { break; }
			vis[i*p] = 1;
            mP[i*p] = p;
			if (i%p == 0) { break; }  // 线性筛关键优化
		}
	}
	return prime;
}

// 分解质因数
map<int,int> cnt;
for (int y = x; y > 1; y /= mP[y]) {
    ++cnt[mP[y]];
}
```
