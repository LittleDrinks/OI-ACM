```cpp
auto work = [&](auto&& cmp) -> void {
	deque<pair<int,int>> q;

	auto update = [&](int id, int x) -> void {
		while (!q.empty() && cmp(x, q.back().second)) {
			q.pop_back();
		}
		q.emplace_back(id, x);
	};

	for (int i = 1; i <= k; ++i) {
		update(i, a[i]);
	}
	for (int i = 1, j = i+k-1; j <= n; ++i, ++j) {
		while (!q.empty() && q.front().first < i) { q.pop_front(); }
		update(j, a[j]);
		cout << q.front().second << " \n"[j == n];
	}
};
```
