---
tags:
---
根据费马小定理 $a^{p-1}\equiv1\pmod p$，得 $a^{p-2}\equiv\dfrac{1}{a}\pmod p$，据此计算乘法逆元。
要求模数为质数，且 $a$ 不是 $p$ 的倍数。
```cpp
const int MOD=998244353;
ll qpow(ll a, ll b=MOD-2)
{   // 快速幂函数，x 的乘法逆元为 qpow(x)
    ll res=1;
    for (; b; b>>=1) {
        if (b & 1) { res=(res*a)%MOD; }
        a = a*a%MOD;  // 不要少 MOD
    }
    return res;
}
```
预处理 $1$ 到 $n$ 的乘法逆元
```cpp
Inv[1] = 1;
for (int i = 2; i <= n; ++i) {
	Inv[i] = (ll)(MOD - MOD / i) * Inv[MOD % i] % MOD;
}
// 另一种写法
fac[0] = Inv[0] = 1;
for (int i = 1; i <= N; ++i) { fac[i] = mul(fac[i-1], i); }
Inv[N] = qpow(fac[N]);
for (int i = N - 1; i; --i) { Inv[i] = mul(Inv[i + 1], i + 1); }
```
直接计算排列组合数
```cpp
const int N=1e5;
ll fac[N+5], Inv[N+5];
ll C(ll n, ll k) { return n==0? 1: fac[n] * Inv[k] % MOD * Inv[n-k] % MOD; }
ll P(ll n, ll k) { return n==0? 1: fac[n] * Inv[n-k] % MOD; }
```
python 高精度版。
```python
import math
def C(n, k):
    return math.factorial(n)//math.factorial(k)//math.factorial(n-k)
```
